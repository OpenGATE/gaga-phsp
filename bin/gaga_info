#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import click
import gaga
from matplotlib import pyplot as plt

CONTEXT_SETTINGS = dict(help_option_names=['-h', '--help'])
@click.command(context_settings=CONTEXT_SETTINGS)
@click.argument('pth_filename', nargs=-1)
@click.option('--plot/--no-plot', default=False)
def gaga_info(pth_filename, plot):
    '''
    \b
    Print info about a trained GAN-PTH (Phase Space File)

    If plot option: plot the loss wrt epoch

    \b
    <PTH_FILENAME> : input PTH file (.pth)
    '''

    if plot:
        fig, ax = plt.subplots(1, 3, figsize=(16,5))
    
    for f in pth_filename:
        params, G, optim, dtypef = gaga.load(f)
        gaga.print_info(params, optim)
        if plot:
            gaga.plot_epoch(ax, optim, f)
            gaga.plot_epoch_wasserstein(ax, optim, f)

    if plot:
        plt.tight_layout()
        plt.savefig('a.pdf', dpi=fig.dpi)
        plt.show()

# --------------------------------------------------------------------------
if __name__ == '__main__':
    gaga_info()

